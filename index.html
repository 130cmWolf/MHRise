<!doctype html>
<html lang="ja">
  <head>
    <meta http-equiv="content-type" content="text/html; charset=utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>MHRise Random Select Quest</title>
    <link href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.1/css/bootstrap.min.css"

      rel="stylesheet">
    <meta name="description" content="モンスターハンターライズ(Monster Hunter Rise)のクエストランダム選択ツールです。エンドコンテンツ化しつつある状態でどのクエストに行ったらいいか悩む時に使います">
    <meta name="generator" content="BlueGriffon wysiwyg editor">
  </head>
  <body>
    <div class="yui-t1"> <divclass="page-header">
        <h1>MHRise Random Select Quest</h1>
      </divclass="page-header"></div>
    <button type="button" class="btn btn-default" id="next">NextQuest</button>
    <table class="table" id="RandomQuest">
    </table>
    ランダムで選ばれるクエスト一覧<br />
    更新日 : <span id="updateDay"></span>
    <table class="table" id="Quest_List">
    </table>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.1/jquery.min.js"></script>
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.1/js/bootstrap.min.js"></script>
    <script type="text/javascript">

        var timer;
        var count = 0;
        const RandomQuest = document.getElementById('RandomQuest');

        $('#next').on('click', function() {
          count = 0;
          if(timer)
            clearInterval(timer);
          timer = setInterval(getQuest, 10);
        });
        
        var getQuest = function(){
          let insertElement = '';
          quest = dataArray[Math.floor(Math.random() * dataArray.length)];
          insertElement += '<tr>';
          insertElement += `<td>${quest.rank}</td>`;
          insertElement += `<td>${quest.title}</td>`;
          insertElement += `<td>${quest.target}</td>`;
          insertElement += '</tr>';
          RandomQuest.innerHTML = insertElement;
          if(count++ >5){
            clearInterval(timer);
            timer=null;
          }
        }
        
        var dataArray;
        const output_csv = document.getElementById('Quest_List');

        $.getJSON("QuestList.json", (data) => {
          const updateDay = document.getElementById('updateDay');
          updateDay.innerHTML = data.updateDay;
          dataArray = data.quest;
          let insertElement = '';
          data.quest.forEach((quest) => {
              insertElement += '<tr>';
              insertElement += `<td>${quest.rank}</td>`;
              insertElement += `<td>${quest.title}</td>`;
              insertElement += `<td>${quest.target}</td>`;
              insertElement += '</tr>';
          });
          output_csv.innerHTML = insertElement;
        });

        </script>
  </body>
</html>
